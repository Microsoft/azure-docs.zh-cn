---
title: 分区和采样：模块参考
titleSuffix: Azure Machine Learning service
description: 了解如何在 Azure 机器学习服务中使用分区和采样模块来对数据集执行采样或从你的数据集创建分区。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 05/02/2019
ROBOTS: NOINDEX
ms.openlocfilehash: 72f9e11e3582d804eecc7479ea079276564bd12f
ms.sourcegitcommit: 4b9c06dad94dfb3a103feb2ee0da5a6202c910cc
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/02/2019
ms.locfileid: "65029275"
---
# <a name="partition-and-sample-module"></a>分区和采样模块

本指南介绍了 Azure 机器学习服务的可视界面 （预览版） 的模块。

若要对数据集执行采样或从你的数据集创建分区，请使用此模块。

采样是机器学习，因为它可以降低数据集的大小，同时保持相同比率的值中的一个重要工具。 此模块支持在机器学习中非常重要的几个相关的任务： 

- 将数据分割成大小相同的多个小节。 

    可以使用分区进行交叉验证，或将用例分配给随机组。

- 将数据分成组，然后处理特定组中的数据。 

    随机分配到不同的组的情况下后, 可能需要修改与一组相关联的功能。

- 采样。 

    可以提取的数据的百分比，应用随机采样，或选择一个列用于平衡数据集并对其值执行分层的采样。

- 创建用于测试的较小数据集。 

    如果有大量数据，你可能想要使用仅在首*n*设置试验，，然后切换到在生成模型时使用的完整数据集时的行。 采样还可用于在开发过程中创建使用 s 较小数据集。

## <a name="configure-partition-and-sample"></a>配置分区和采样

此模块支持多个方法，用于将数据划分为分区或采样。 首先，选择的方法，然后设置附加选项所需的方法。

- 标头
- 采样
- 将分配给折叠
- 选择折叠

### <a name="get-top-n-rows-from-a-dataset"></a>获取从数据集中的前 N 行

使用此模式来仅获取前*n*行。 如果想要测试实验上少量的行，且不需要平衡或以任何方式采样的数据，此选项非常有用。

1. 添加**分区和采样**在界面中，在试验的模块并连接数据集。  

2. **分区或采样模式**:此选项设置为**Head**。

3. **要选择的行数**:键入要返回行的数。

    您指定的行数必须为非负整数。 如果所选的行数大于数据集中的行数，则返回整个数据集。

4. 运行试验。

该模块将输出一个包含仅指定的行数的单个数据集。 从数据集上始终读取行。

### <a name="create-a-sample-of-data"></a>创建示例数据

此选项支持简单的随机采样或分层随机采样。 这是你想要创建用于测试的较小代表性示例数据集的情况下很有用。

1. 添加**分区和采样**模块在试验中，并连接数据集。

2. **分区或采样模式**:将此设置为**采样**。

3. **采样率**:键入一个介于 0 和 1 之间的值。 此值指定应包括在输出数据集的源数据集中的行的百分比。

    例如，如果你想仅一半的原始数据集，则键入`0.5`以指示采样率为 50%。

    输入数据集的行随机排布并有选择地将放入输出数据集，根据指定的比率。

4. **采样的随机种子**:（可选） 键入要用作种子值的整数。

    此选项非常重要，如果你想要被除相同方式每次的行。 默认值为 0，含义的起始种子，会生成基于系统时钟。 这可能导致结果略有不同每次运行试验。

5. **采样的分层的拆分**:当有必要在数据集中的行应该平均划分通过之前采样某些键列，请选择此选项。

    有关**采样的分层键列**，选择一个*阶层列*划分数据集时使用。 在数据集中的行被划分然后按如下所示：

    1. 所有输入的行分组 （分层） 中指定的阶层列的值。

    2. 行随机排布每个组中。

    3. 每个组有选择地添加到输出数据集来满足指定的比率。


6. 运行试验。

    使用此选项，该模块将输出包含代表性的数据的单个数据集。 不输出数据集的剩余未采样部分。 

## <a name="split-data-into-partitions"></a>将数据拆分为分区

如果你想要将数据集划分为子集的数据，请使用此选项。 此选项也是有用时您希望创建一个自定义的用于交叉验证折叠数或行拆分成若干个组。

1. 添加**分区和采样**模块在试验中，并连接数据集。

2. 有关**分区或示例模式**，选择**分配给折叠**。

3. **中的分区使用替换**:如果想要采样的行要返回到池中的行的潜在的重复使用，请选择此选项。 因此，同一行可能会分配给多个折叠。

    如果不使用替换 （默认选项），采样的行不放回到的行的潜在的重复使用池。 因此，每一行可以分配到仅一个折叠。

4. **随机化的拆分**:如果你想要将随机分配给折叠的行，请选择此选项。

    如果不选择此选项，行都分配给折叠使用轮循机制方法。

5. **随机种子**:（可选） 键入要用作种子值的整数。 此选项非常重要，如果你想要被除相同方式每次的行。 否则，默认值为 0 意味着，随机起始种子将使用。

6. **指定分区器方法**:指示您希望如何数据分配到每个分区，使用这些选项：

    - **均衡分区**:使用此选项将每个分区中相同的行数。 若要指定输出分区数，请键入内的整数**指定要均衡拆分成的折叠数**文本框。

    - **使用自定义比例分区**:使用此选项以指定每个分区的大小作为以逗号分隔列表。

        例如，如果你想要创建三个分区，与第一个分区包含 50%的数据，以及剩余的两个分区各包含 25%的数据，请单击**逗号分隔的比例列表**文本框中，并键入这些编号： `.5, .25, .25`

        所有分区大小的总和必须添加到完全的 1。

        - 如果输入添加最多的数字**数少于 1 个**，创建额外分区来保存剩余行。 例如，如果键入.2 和.3，第三个值创建分区包含的所有行的其余的 50%。

        - 如果输入添加最多的数字**超过 1**，运行试验时，将引发错误。

7. **分层的拆分**:选择此选项，如果你想要分层的行时拆分，，然后选择_阶层列_。

8. 运行试验。

    使用此选项，该模块将输出多个数据集，使用你指定的规则分区。

### <a name="use-data-from-a-predefined-partition"></a>使用预定义的分区中的数据  

当已经将数据集划分为多个分区，现在想要进行进一步分析或处理反过来加载每个分区时使用此选项。

1. 添加**分区和采样**到实验的模块。

2. 将其连接到的前一个实例的输出**分区和采样**。 必须使用该实例**分配给折叠**选项以生成一定数量的分区。

3. **分区或采样模式**:选择**选择折叠**。

4. **指定要从中采样的折叠**:选择要使用通过键入其索引的分区。 分区索引是从 1 开始。 例如，如果数据集分为三个部分，分区将具有索引 1、 2 和 3。

    如果键入无效的索引值，将引发一个设计时错误："错误 0018:数据集包含无效的数据。"

    除了按折叠分组数据集，可以将数据集分隔成两组： 目标折叠和其他所有内容。 若要执行此操作键入单个折叠的索引，然后选择的选项**选取所选折叠的补数**，以指定折叠中获取数据以外的所有内容。

5. 如果您正在使用多个分区，则必须添加的其他实例**分区和采样**模块以处理每个分区。

    例如，为使用年龄的四个折叠假设之前已分区的患者。 若要使用每个单个折叠，您需要四个副本**分区和采样**模块，并在每个，你选择不同的折叠，如下所示。 不正确使用**分配给折叠**直接输出。  

    [![分区和采样](./media/partition-and-sample/partition-and-sample.png)](./media/partition-and-sample/partition-and-sample-lg.png#lightbox)

5. 运行试验。

    使用此选项，该模块将输出单个数据集包含只有分配给该折叠的行。

> [!NOTE]
>  不能直接; 查看折叠标志它们是仅在元数据中存在。

## <a name="next-steps"></a>后续步骤

请参阅[可用的模块集](module-reference.md)到 Azure 机器学习服务。 