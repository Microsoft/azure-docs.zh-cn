---
title: 计算和存储选项-Azure Database for PostgreSQL-灵活服务器
description: 本文介绍 Azure Database for PostgreSQL 灵活的服务器中的计算和存储选项。
author: lfittl-msft
ms.author: lufittl
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2020
ms.openlocfilehash: ca60c44d1e167367e2c138af1e7bfd4ba1a69417
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/09/2020
ms.locfileid: "91710067"
---
# <a name="compute-and-storage-options-in-azure-database-for-postgresql---flexible-server"></a>Azure Database for PostgreSQL 灵活的服务器中的计算和存储选项

> [!IMPORTANT]
> Azure Database for PostgreSQL 灵活服务器以预览版提供

可以在三个不同的定价层中的一种创建 Azure Database for PostgreSQL 服务器：可突增、常规用途和内存优化。 定价层的差异表现在可以预配的 vCore 中的计算量、每个 vCore 的内存，以及用于存储数据的存储技术。 所有资源都在 PostgreSQL 服务器级别预配。 一个服务器可以有一个或多个数据库。

| 资源/层 | **可突增** | **常规用途** | **内存优化** |
|:---|:----------|:--------------------|:---------------------|
| vCore 数 | 1, 2 | 2，4，8，16，32，48，64 | 2，4，8，16，32，48，64 |
| 每个 vCore 的内存 | 变量 | 4 GB | 6.75 到 8 GB |
| 存储大小 | 32 GB 到 16 TB | 32 GB 到 16 TB | 32 GB 到 16 TB |
| 数据库备份保留期 | 7 到 35 天 | 7 到 35 天 | 7 到 35 天 |

可以从下表着手来选择定价层。

| 定价层 | 目标工作负荷 |
|:-------------|:-----------------|
| 可突增 | 最适用于不连续需要完全 CPU 的工作负载。 |
| 常规用途 | 大多数业务工作负荷。此类工作负荷需要均衡的计算和内存以及可缩放的 I/O 吞吐量。 相关示例包括用于托管 Web 和移动应用的服务器，以及其他企业应用程序。|
| 内存优化 | 高性能数据库工作负荷。此类工作负荷需要内存中性能来实现更快的事务处理速度和更高的并发性。 相关示例包括用于处理实时数据的服务器，以及高性能事务性应用或分析应用。|

创建服务器后，可以在数秒内更改计算层、Vcore 数和存储大小。 你还可以在备份保持期的最大范围内进行单独调整。 有关详细信息，请参阅[缩放资源](#scale-resources)部分。

## <a name="compute-tiers-vcores-and-server-types"></a>计算层、Vcore 和服务器类型

可以基于层、Vcore 和内存大小选择计算资源。 Vcore 表示基础硬件的逻辑 CPU。

可用服务器类型的详细规范如下：

| SKU 名称             | vCore 数 | 内存大小 | 支持的最大 IOPS | 支持的最大 i/o 带宽 |
|----------------------|--------|-------------|--------------------|-----------------------------|
| **可突增**        |        |             |                    |                             |
| B1ms                 | 1      | 2 GiB       | 640                | 15 MiB/秒                  |
| B2s                  | 2      | 4 GiB       | 1280               | 15 MiB/秒                  |
| **常规用途**  |        |             |                    |                             |
| D2s_v3               | 2      | 8 GiB       | 3200               | 48 MiB/秒                  |
| D4s_v3               | 4      | 16 GiB      | 6400               | 96 MiB/秒                  |
| D8s_v3               | 8      | 32 GiB      | 12800              | 192 MiB/秒                 |
| D16s_v3              | 16     | 64 GiB      | 18000              | 384 MiB/秒                 |
| D32s_v3              | 32     | 128 GiB     | 18000              | 750 MiB/秒                 |
| D48s_v3              | 48     | 192 GiB     | 18000              | 750 MiB/秒                 |
| D64s_v3              | 64     | 256 GiB     | 18000              | 750 MiB/秒                 |
| **内存优化** |        |             |                    |                             |
| E2s_v3               | 2      | 16 GiB      | 3200               | 48 MiB/秒                  |
| E4s_v3               | 4      | 32 GiB      | 6400               | 96 MiB/秒                  |
| E8s_v3               | 8      | 64 GiB      | 12800              | 192 MiB/秒                 |
| E16s_v3              | 16     | 128 GiB     | 18000              | 384 MiB/秒                 |
| E32s_v3              | 32     | 256 GiB     | 18000              | 750 MiB/秒                 |
| E48s_v3              | 48     | 384 GiB     | 18000              | 750 MiB/秒                 |
| E64s_v3              | 64     | 432 GiB     | 18000              | 750 MiB/秒                 |

## <a name="storage"></a>存储

预配的存储是指可供 Azure Database for PostgreSQL 服务器使用的存储容量。 此存储用于数据库文件、临时文件、事务日志和 PostgreSQL 服务器日志。 预配的总存储量也定义了可供服务器使用的 I/O 容量。

存储提供以下固定大小：

| 磁盘大小 | IOPS |
|:---|:---|
| 32 GiB | 预配120，最高3500 |
| 64 GiB | 预配240，最高3500 |
| 128 GiB | 预配500，最高3500 |
| 256 GiB | 预配1100，最高3500 |
| 512 GiB | 预配2300，最高3500 |
| 1 TiB | 5,000 |
| 2 TiB | 7,500 |
| 4 TiB | 7,500 |
| 8 TiB | 16,000 |
| 16 TiB | 18,000 |

请注意，IOPS 还受 VM 类型的限制。 尽管您可以选择任何独立于服务器类型的存储大小，但可能无法使用存储提供的所有 IOPS，尤其是在选择 Vcore 的服务器时。

在创建服务器的过程中和之后，可以添加更多的存储容量。

>[!NOTE]
> 存储只能增加，不能减少。

可以通过 Azure 门户或 Azure CLI 命令监视 I/O 使用情况。 要监视的相关指标是[存储上限、存储百分比、已用存储和 IO 百分比](concepts-monitoring.md)。

### <a name="maximum-iops-for-your-configuration"></a>配置的最大 IOPS

|SKU 名称            |GiB 中的存储大小                       |32 |64 |128 |256 |512  |1,024|2,048|4,096|8,192 |16,384|
|--------------------|------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |最大 IOPS                              |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**可突增**       |                                          |   |   |    |    |     |     |     |     |      |      |
|B1ms                |640 IOPS                                  |120|240|500 |640 *|640 * |640 * |640 * |640 * |640 *  |640 *  |
|B2s                 |1280 IOPS                                 |120|240|500 |1100|1280 *|1280 *|1280 *|1280 *|1280 * |1280 * |
|**常规用途** |                                          |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |3200 IOPS                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|D4s_v3              |6400 IOPS                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|D8s_v3              |12800 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|D16s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D32s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D48s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D64s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**内存优化**|                                          |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |3200 IOPS                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|E4s_v3              |6400 IOPS                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|E8s_v3              |12800 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|E16s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E32s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E48s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E64s_v3             |18000 IOPS                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |

标记为时 \* ，IOPS 受所选 VM 类型的限制。 否则，IOPS 受选定存储大小的限制。

### <a name="maximum-io-bandwidth-mibsec-for-your-configuration"></a>配置的最大 i/o 带宽 (MiB/秒) 

|SKU 名称            |存储大小，GiB                             |32 |64 |128 |256 |512  |1,024|2,048|4,096|8,192 |16,384|
|--------------------|----------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |**存储带宽，MiB/秒**                |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**可突增**       |                                              |   |   |    |    |     |     |     |     |      |      |
|B1ms                |10 MiB/秒                                    |万|万|万 |万 |万  |万  |万  |万  |万   |万   |
|B2s                 |15 MiB/秒                                    |15|15|15 |15 |15  |15  |15  |15  |15   |15   |
|**常规用途** |                                              |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |48 MiB/秒                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|D4s_v3              |96 MiB/秒                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|D8s_v3              |192 MiB/秒                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|D16s_v3             |384 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|D32s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D48s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D64s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**内存优化**|                                              |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |48 MiB/秒                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|E4s_v3              |96 MiB/秒                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|E8s_v3              |192 MiB/秒                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|E16s_v3             |384 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|E32s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E48s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E64s_v3             |750 MiB/秒                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |

标记为时 \* ，i/o 带宽受所选 VM 类型的限制。 否则，i/o 带宽受选存储大小的限制。

### <a name="reaching-the-storage-limit"></a>达到存储限制

达到存储限制时，服务器将开始返回错误，并阻止任何进一步的修改。 这也可能会导致其他操作活动（例如，备份和 WAL 存档）出现问题。

建议主动监视正在使用的磁盘空间，并将磁盘大小增加到超出存储的任何情况。 你可以设置警报，以便在服务器存储空间即将用完时通知你，这样你就可以避免在磁盘空间不足时出现任何问题。 有关详细信息，请参阅有关[如何设置警报](howto-alert-on-metrics.md)的文档。

### <a name="storage-auto-grow"></a>存储自动增长

存储自动增长目前尚不可用于灵活的服务器。

## <a name="backup"></a>Backup

服务自动对服务器进行备份。 可以选择 7 到 35 天的保留期。 若要详细了解备份，请参阅[概念文章](concepts-backup-restore.md)。

## <a name="scale-resources"></a>缩放资源

创建服务器后，可以独立地更改 Vcore、计算层、存储量和备份保留期。 可以向上或向下调整 VCore 数。 备份保留期可以从 7 天到 35 天进行上下调整。 存储大小只能增加。 可以通过门户或 Azure CLI 缩放资源。

> [!NOTE]
> 存储大小只能增加。 增加后，将不能返回到更小的存储大小。

更改 Vcore 或计算层的数目时，服务器将重新启动，以使新的服务器类型生效。 在系统切换到新服务器的短暂期间，无法建立新的连接，所有未提交的连接将会回退。 此时段不定，但大多数情况下短于一分钟。 缩放存储的方式与此相同，并且还需要短时间重启。

更改备份保留期是一个联机操作。

## <a name="pricing"></a>定价

有关最新定价信息，请参阅服务的[定价页](https://azure.microsoft.com/pricing/details/PostgreSQL/)。 若要查看所需配置的具体成本，可以单击 [Azure 门户](https://portal.azure.com/#create/Microsoft.PostgreSQLServer)的“定价层”选项卡，系统就会根据选定的选项显示每月成本。 如果没有 Azure 订阅，可使用 Azure 定价计算器获取估计的价格。 在 [Azure 定价计算器](https://azure.microsoft.com/pricing/calculator/)网站上，选择“添加项”  ，展开“数据库”  类别，选择“Azure Database for PostgreSQL”  自定义选项。

## <a name="next-steps"></a>后续步骤

- 了解如何[在门户中创建 PostgreSQL 服务器](how-to-manage-server-portal.md)。
- 了解[服务限制](concepts-limits.md)。
