---
title: 内置 & 自定义警报列表
description: 了解如何使用适用于 IoT 功能和服务的安全警报和建议的补救措施。
services: defender-for-iot
ms.service: defender-for-iot
documentationcenter: na
author: elazark
manager: rkarlin
editor: ''
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/08/2020
ms.author: v-ekrieg
ms.openlocfilehash: c4c92bfa25d9c43d3c654fbd1f23e242effc7577
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/09/2020
ms.locfileid: "91851197"
---
# <a name="defender-for-iot-security-alerts"></a>Defender for IoT 安全警报

Defender for IoT 使用高级分析和威胁情报持续分析 IoT 解决方案，以提醒你应对恶意活动。
此外，你可以根据预期设备行为的了解来创建自定义警报。
警报可作为潜在危害的指标，并应进行调查和修正。

在本文中，你将找到内置警报列表，这些警报可在 IoT 中心和/或 IoT 设备上触发。
除了内置警报外，Defender for IoT 还允许你根据预期的 IoT 中心和/或设备行为定义自定义警报。
有关详细信息，请参阅 [可自定义警报](concept-customizable-security-alerts.md)。

## <a name="built-in-alerts-for-iot-devices"></a>IoT 设备的内置警报

| 名称 | 严重性 | 数据源 | 说明 | 建议的修正步骤|
|----------|---------------|-------------|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|**高** 严重性|  |  |  |
|   二进制命令行   | 高 | 代理 | 检测到从命令行调用/执行了 LA Linux 二进制文件。 此过程可能是合法活动，也可能表示设备已泄露。|   与运行该命令的用户一起查看该命令，并检查这是否是需要在设备上运行的合法内容。 否则，请将警报升级到信息安全团队。 |
|   禁用防火墙   | 高                                      | 代理       | 检测到主机上防火墙的可能操作。 恶意执行组件通常会在尝试盗取数据时禁用宿主防火墙。|  查看运行命令的用户，以确认这是否是设备上合法的预期活动。 否则，请将警报升级到信息安全团队。 |
|   端口转发检测   | 高| 代理  | 检测到检测到外部 IP 地址的端口转发。|  如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。 |
|   可能尝试禁用检测到的审核日志记录   | 高 | 代理       | Linux 审核 system 提供一种方法来跟踪系统上的安全相关信息。 系统会记录尽可能多的有关系统上发生的事件的信息。 此信息对于任务关键型环境非常重要，可以确定违反安全策略的人员及其执行的操作。 禁用审核日志记录可能会阻止你发现系统上使用的安全策略的冲突。 |如果这是具有业务原因的合法活动，请与设备所有者核实。 如果不是，则此事件可能会被恶意执行组件隐藏。 立即将事件上报给你的信息安全团队。|
|   反向 shell   | 高 | 代理 | 设备上的主机数据分析检测到可能的反向外壳。 反向 shell 通常用于获取被入侵的计算机，以回调由恶意执行组件控制的计算机。|  如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。  |
|  成功的 Bruteforce 尝试   | 高  | 代理       | 标识多次失败的登录尝试，然后成功登录。 尝试 Bruteforce 的攻击可能已在设备上成功。 | 查看设备上的 SSH Bruteforce 警报和活动。 <br>如果活动为恶意活动：<br> 向泄露的帐户推出密码重置。<br> 如果发现恶意软件) 设备，请调查和修正 (。  |
|  本地登录成功   |   高                           | 代理       | 检测到设备的本地登录成功 | 请确保已登录的用户是授权方。  |
|   Web 外壳   | 高 | 代理 | 检测到可能的 web shell。 恶意参与者通常会将 web shell 上传到受损的计算机，以获取持久性或进一步利用。|  如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。 |
|**中** 严重性|  |  |  |
|   检测到与常见的 Linux 机器人类似的行为 | 中型| 代理 | 通常与检测到的常见 Linux 僵尸网络相关联的进程的执行。| 如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。 |
|  检测到与 Fairware 勒索软件类似的行为  | 中型 | 代理       | Rm 的执行-rf 命令应用到使用主机数据分析检测到的可疑位置。 由于 rm-rf 递归删除文件，因此通常仅用于离散文件夹。 在这种情况下，将在可能删除大量数据的位置使用它。 我们知道，Fairware 勒索软件会在此文件夹中执行 rm -rf 命令。 |查看运行命令的用户，这是你希望在设备上看到的合法活动。 否则，请将警报升级到信息安全团队。
|  类似于检测到勒索软件的行为  | 中型 | 代理       | 执行类似于已知勒索软件的文件，这些文件可能会阻止用户访问其系统或个人文件，并可能需要 ransom 付款才能重新获得访问权限。|如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|   检测到加密硬币挖掘器容器映像 | 中型                   | 代理       | 检测正在运行的已知数字货币挖掘映像的容器。 |  1. 如果此行为不适用，请删除相关容器映像。<br> 2. 确保无法通过不安全的 TCP 套接字访问 Docker 守护程序。<br> 3. 将警报升级到信息安全团队。|
|  加密硬币挖掘器图  | 中型| 代理       | 执行通常与检测到的数字货币挖掘关联的进程。| 如果这是设备上的合法活动，请与运行该命令的用户核实。 否则，请将警报升级到信息安全团队。|
|   检测到对 nohup 命令的可疑使用 | 中型 | 代理       | 在检测到主机上的 nohup 命令的可疑使用。 恶意执行组件通常从临时目录运行 nohup 命令，从而有效地允许其可执行文件在后台运行。 如果在临时目录中的文件上运行此命令，则不是预期的行为或正常行为。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|   检测到对 useradd 命令的可疑使用  | 中型      | 代理       | 在设备上检测到的 useradd 命令的可疑使用。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  由 TCP 套接字公开的 Docker 守护程序  | 中型 | 代理 | 计算机日志指示 Docker 守护程序 (dockerd) 公开了一个 TCP 套接字。 默认情况下，启用 TCP 套接字时，Docker 配置不会使用加密或身份验证。 默认 Docker 配置允许有权访问相关端口的任何人均可完全访问 Docker 守护程序。|如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  本地登录失败  | 中型 | 代理       | 检测到对设备的本地登录尝试失败。 |请确保没有任何未经授权的参与方具有对设备的物理访问权限。|
|  检测到来自已知恶意源的文件下载   | 中型  | 代理       |  从检测到的已知恶意软件源下载文件。|如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|   检测到 .htaccess 文件访问 | 中型                       | 代理       | 分析主机数据检测到 .htaccess 文件的可能操作。 .Htaccess 是一个功能强大的配置文件，可让你对运行 Apache Web 软件的 web 服务器进行多项更改（包括基本重定向功能）以及更高级的功能，例如基本密码保护。 恶意执行组件经常修改受损计算机上的 .htaccess 文件以获得持久性。 |确认主机上是否出现了合法的预期活动。 否则，请将警报升级到信息安全团队。|
|  已知攻击工具  | 中型                                   | 代理       | 检测到的工具经常与恶意用户攻击其他计算机。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。|
|  已尝试 IoT 代理，但未能分析模块克隆配置 | 中型  | 代理       | 由于配置对象中的类型不匹配，IoT security agent 的 Defender 未能分析模块克隆配置|针对 IoT 代理配置架构验证模块克隆配置，修复所有不匹配的情况。
|  检测到本地主机侦查  | 中型 | 代理       | 执行通常与检测到的常见 Linux 机器人侦测关联的命令。 |查看可疑的命令行，确认它是由合法用户执行的。 否则，请将警报升级到信息安全团队。
|  脚本解释器与文件扩展名不匹配  | 中型 | 代理       | 脚本解释器与检测到的输入所提供的脚本文件扩展名不匹配。 这种类型的不匹配通常与攻击者脚本执行相关联。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  检测到可能的后门  | 中型 | 代理 |已下载可疑文件，然后在订阅中的主机上运行该文件。 这种类型的活动通常与后门的安装相关联。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
| 检测到可能丢失数据  | 中型 | 代理 | 使用主机数据分析检测到可能的数据出口情况。 恶意执行组件通常会传出被泄露的计算机。|如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  常见文件的潜在替代活动 | 中型  | 代理 | 设备上覆盖的常见可执行文件。 恶意执行组件被识别为覆盖公共文件，这是一种隐藏其操作或获取持久性的方式。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|   检测到特权容器 | 中型 | 代理       | 计算机日志指示有特权 Docker 容器正在运行。 特权容器对宿主资源具有完全访问权限。 如果受到侵害，恶意参与者可以使用特权容器获取对主机的访问权限。|如果容器无需在特权模式下运行，请从容器中删除权限。
| 检测到删除了系统日志文件  | 中型 | 代理       | 检测到删除了主机上的日志文件。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  Filename 后面的空格  | 中型| 代理 | 使用主机数据分析检测到具有可疑扩展的进程的执行。 可疑扩展可能会诱使用户认为文件是安全打开的，并且可能表明系统上存在恶意软件。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  检测到可疑的恶意凭据访问工具  | 中型 | 代理       | 检测与恶意尝试访问凭据相关的工具的使用情况。 |  如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。|
|   检测到可疑的编译 | 中型  | 代理       | 检测到可疑的编译。 恶意执行组件通常会在受攻击的计算机上编译攻击以提升权限。  |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。
|  可疑文件下载，后跟文件运行活动  | 中型| 代理| 分析主机数据检测到已下载并在同一命令中运行的文件。 恶意执行组件通常使用此方法来获取受感染的文件到受害者计算机上。 |如果这是你希望在设备上看到的合法活动，请查看运行该命令的用户。 否则，请将警报升级到信息安全团队。|
|  可疑 IP 地址通信 | 中型  | 代理       | 检测到与可疑 IP 地址的通信。 |验证连接是否合法。 请考虑阻止与可疑 IP 的通信。 |
|**低** 严重性|  |  |  |
|    Bash 历史记录已清除   | 低                                  | 代理       | Bash 历史记录日志已清除。 恶意执行组件通常会擦除 bash 历史记录，以隐藏它们在日志中显示的命令。 |查看运行命令的用户，此警报中的活动会将此命令识别为合法的管理活动。 否则，请将警报升级到信息安全团队。
|   设备无提示    | 低 | 代理       | 设备在过去72小时内未发送任何遥测数据。|请确保设备已联机并发送数据。 检查 Azure 安全代理是否正在设备上运行。|
|  失败的 Bruteforce 尝试 | 低 | 代理       | 标识多个失败的登录尝试。 设备上可能的 Bruteforce 攻击尝试失败。 |查看设备上的 SSH Bruteforce 警报和活动。 无需进一步操作。|
|  已将本地用户添加到一个或多个组 | 低                            | 代理     | 已将新的本地用户添加到此设备上的组。 对用户组所做的更改不太常见，可以指示恶意执行组件可能正在收集其他权限。|  验证更改是否与受影响的用户所需的权限一致。 如果更改不一致，请升级到信息安全团队。  |
|  从一个或多个组删除本地用户 | 低                            | 代理     | 已从一个或多个组删除本地用户。 已知恶意执行组件在尝试拒绝合法用户的访问或删除其操作历史记录时，可以使用此方法。|  验证更改是否与受影响的用户所需的权限一致。 如果更改不一致，请升级到信息安全团队。  |
|  检测到本地用户删除 | 低                            | 代理     | 检测到删除了本地用户。 本地用户删除很少，恶意执行组件可能试图拒绝合法用户的访问或删除其操作的历史记录。|  验证更改是否与受影响的用户所需的权限一致。 如果更改不一致，请升级到信息安全团队。  |

## <a name="built-in-alerts-for-iot-hub"></a>IoT 中心的内置警报

| 严重性 | 名称                                                                         | 说明 | 建议的补救措施|
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
|**中** 严重性|  |  |  |
|  添加到 IoT 中心的新证书  | 中型                                     |已将名为 \' % {DescCertificateName} 的证书 \' 添加到 IoT 中心 \' % {DescIoTHubName} \' 。 如果此操作是由未经授权的参与方做出的，则可能指示恶意活动。| 1. 确保证书已由授权方添加。 <br> 2. 如果未由授权方添加，请删除证书，并将警报升级到组织安全团队。  |
|  从 IoT 中心删除证书  | 中型                             | 已 \' \' 从 IoT 中心 \' % {DescIoTHubName} 中删除名为% {DescCertificateName} 的证书 \' 。 如果此操作是由未经授权的参与方进行的，则可能表示存在恶意活动。| 1. 确保证书已被授权方删除。 <br> 2. 如果证书未被授权方删除，请将该证书添加回，并将警报升级到组织安全团队。 |
| 检测到将证书添加到 IoT 中心的尝试失败   | 中型    | 尝试将证书 \' % {DescCertificateName} 添加 \' 到 IoT 中心 \' % {DescIoTHubName} 失败 \' 。 如果此操作是由未经授权的参与方做出的，则可能指示恶意活动。|   请确保仅向授权方授予更改证书的权限。  |
|  检测到从 IoT 中心删除证书的尝试失败 | 中型  | 尝试 \' \' 从 IoT 中心 \' % {DescIoTHubName} 删除证书% {DescCertificateName} 失败 \' 。 如果此操作是由未经授权的参与方做出的，则可能指示恶意活动。 |请确保仅向授权方授予更改证书的权限。|
|  x.509 设备证书指纹不匹配  | 中型           | x.509 设备证书指纹与配置不匹配。 |查看设备上的警报。 无需进一步操作。 |
| x.509 证书已过期  | 中型 |X.509 设备证书已过期。 |  这可能是具有过期证书的合法设备，也可能是模拟合法设备的尝试。 如果合法设备当前正确通信，这可能是模拟尝试。 |
|**低** 严重性|  |  |  |
|   尝试添加或编辑检测到 IoT 中心的诊断设置   | 低     | 检测到尝试添加或编辑 IoT 中心的诊断设置。 使用诊断设置，可以在安全事件发生或网络受到威胁时，重新创建用于调查的活动跟踪。 如果此操作不是由授权方进行的，则可能指示恶意活动。  |1. 确保证书已被授权方删除。<br> 2. 如果证书未被授权方删除，请将该证书添加回，并将警报升级到信息安全团队。
|   尝试从检测到的 IoT 中心删除诊断设置        | 低      | % {DescAttemptStatusMessage} \' 尝试添加或编辑 \' \' IoT 中心 \' % {DescIoTHubName} 的诊断设置% {DescDiagnosticSettingName} \' 。 使用 "诊断" 设置，可以在安全事件发生或网络泄露时重新创建用于调查的活动跟踪。 如果此操作不是由授权方进行的，则可能表示存在恶意活动。 |请确保仅向授权方授予更改诊断设置的权限。|
|   过期的 SAS 令牌    | 低  |  设备使用的过期 SAS 令牌 |可能是带有过期令牌的合法设备，也可能是模拟合法设备的尝试。 如果合法设备当前正确通信，这可能是模拟尝试。|
|  SAS 令牌签名无效 | 低 | 设备使用的 SAS 令牌具有无效的签名。 签名与主密钥或辅助密钥不匹配。|  查看设备上的警报。 无需进一步操作。  |
|

## <a name="next-steps"></a>后续步骤

- Defender for IoT 服务 [概述](overview.md)
- 了解如何 [访问安全数据](how-to-security-data-access.md)
- 了解有关[调查设备的](how-to-investigate-device.md)详细信息
